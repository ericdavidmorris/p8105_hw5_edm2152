---
title: "p8105_hw5_edm2152"
author: "Eric Morris"
date: "11/6/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(p8105.datasets)
library(rvest)
library(purrr)
```

## Problem 1 

```{r, Importing and Tidying Data}

one_df = 
  tibble(participant = list.files("./data", full.names = TRUE)) %>% # Getting all file names using list.files
  mutate(long_data = map(participant, read_csv)) %>% # Using map, similar to Napoleon Dynamite Example to read in the data for each subject
  unnest()

one_df_tidy = # Creating a new data frame for the tidy version of this dataset and tidying 
  one_df %>% 
  separate(participant, into = c("arm", "id"), sep = "_") %>% 
  separate(arm, into = c("filler1", "arm"), sep = "a/") %>% 
  separate(id, into = c("id", "filler2"), sep = ".c") %>% 
  select(-starts_with("fill")) %>% 
  mutate(arm = str_replace(arm, "con", "control"),
         arm = str_replace(arm, "exp", "experimental")) %>%
  gather(key = week, value = observation, week_1:week_8) %>% 
  separate(week, into = c("filler", "week"), sep = "_") %>% 
  select(-filler) %>% 
  mutate(week = as.numeric(week))
```


```{r, Spaghetti Plot}

# I initially converted the id variable to a numeric variable in my tidying above. However, that wasn't working in my plot, so needed to remove that 
# and leave id as a character so I could specificy type in my ggplot to get a line for each participant 

one_df_tidy %>% 
  group_by(arm, id) %>% 
  ggplot(aes(x = week, y = observation, color = arm, type = id)) + 
  geom_point() +
  geom_line() + 
  theme_bw() 

# Make this look pretty and make comment below better 

```

From our line plot, we can see that there appears to be a clear difference between the control and experimental arms. The experimental group appears to increase over time in observation value and the control group appears to hover around the same value or slightly decrease over time. 

## Problem 2 

```{r, Importing Homicide Data}

# I imported the raw file straight from GitHub, just in case the data is updated in the future then those updates will be incoporated in my code

wp_homicide_data_raw = 
  read_csv("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv") %>% 
  janitor::clean_names()

```

Describing the Raw Data: 

```{r, Manipulating the Data}

wp_homicide_data = 
  wp_homicide_data_raw %>% 
  mutate(city_state = str_c(city, state, sep = ", "))

```


